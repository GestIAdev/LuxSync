# âš¡ WAVE 2046.2 â€” HYBRID COCKPIT Phase 2: EL INJERTO

## ğŸ¯ MISIÃ“N
Injertar TheProgrammer (controles de fixtures) dentro de Chronos como panel lateral adaptado al layout horizontal.

## ğŸ“ ARQUITECTURA: EL INJERTO

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     TRANSPORT BAR  [STAGE][QUANT][SNAP][ğŸ›ï¸ RACK]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚                       â”‚
â”‚              STAGE PREVIEW (1fr = 50%)                 â”‚                       â”‚
â”‚                                                         â”‚   CHRONOS LIVE RACK   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   (320px)             â”‚
â”‚                                                         â”‚                       â”‚
â”‚              TIMELINE CANVAS (1fr = 50%)               â”‚   [TheProgrammer      â”‚
â”‚              [ContextualDataSheet = HIDDEN]             â”‚    Content]           â”‚
â”‚                                                         â”‚   Position / Intensityâ”‚
â”‚                                                         â”‚   Color / Beam        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           ARSENAL DOCK (200px)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### LÃ³gica de Visibilidad
```
showRack = isRecording || showLiveControls

Si showRack:
  â”œâ”€ chronos-main â†’ [chronos-workspace] + [ChronosLiveRack (320px)]
  â””â”€ ContextualDataSheet â†’ OCULTO (no compiten por espacio)

Si !showRack:
  â”œâ”€ chronos-main â†’ [chronos-workspace] (100% ancho)
  â””â”€ ContextualDataSheet â†’ VISIBLE (floating HUD como siempre)
```

### CSS Override Strategy
TheProgrammerContent renderiza `<div class="programmer-content">` que hereda
estilos de TheProgrammer.css (pensados para StageSidebar 450px).

**Problema**: `min-width: 450px, max-width: 450px` en `.the-programmer`
**No-problema**: TheProgrammerContent NO usa `.the-programmer` â€” renderiza directamente `.programmer-content`

Scoped overrides en `.chronos-live-rack .programmer-content` ajustan:
- Dimensiones a 320px (mÃ¡s compacto para Chronos)
- Paddings reducidos en header y secciones
- Font sizes ajustados para el espacio menor

### Collapsed State
El rack puede colapsar a un strip vertical de 32px con texto "LIVE" rotado 90Â°.
Toggle via click en el strip o botÃ³n â–¶ en el header.

## ğŸ“¦ INVENTARIO DE ARCHIVOS

### CREADOS (2 archivos nuevos)

| Archivo | LÃ­neas | PropÃ³sito |
|---------|--------|-----------|
| `chronos/ui/rack/ChronosLiveRack.tsx` | ~115 | Wrapper adaptador: header + TheProgrammerContent + collapse |
| `chronos/ui/rack/ChronosLiveRack.css` | ~265 | Layout 320px + collapsed state + scoped overrides |

### MODIFICADOS (3 archivos)

| Archivo | Cambio | Detalle |
|---------|--------|---------|
| `ChronosLayout.tsx` | +import, +state, +handler, +JSX | Import ChronosLiveRack, `showLiveControls` state, `handleToggleLiveControls`, `showRack` derived, condicional en JSX |
| `TransportBar.tsx` | +2 props, +destructure, +botÃ³n | `showLiveControls?`, `onToggleLiveControls?`, botÃ³n RACK en zona de MODES |
| `TransportBar.tsx` (props) | +interface | AÃ±adido `showLiveControls?` y `onToggleLiveControls?` a TransportBarProps |

### NO TOCADOS (reutilizados as-is)

| Archivo | Por quÃ© |
|---------|---------|
| `TheProgrammerContent.tsx` | Se usa tal cual â€” sin modificaciÃ³n |
| `TheProgrammer.css` | Sus estilos se sobreescriben via scoped `.chronos-live-rack` |
| `selectionStore.ts` | TheProgrammerContent lo usa internamente |
| `truthStore.ts` | TheProgrammerContent lo usa internamente |

## âœ… COMPILACIÃ“N

```
ChronosLiveRack.tsx   â†’ 0 errores âœ…
ChronosLiveRack.css   â†’ 0 errores âœ…
ChronosLayout.tsx     â†’ 0 errores âœ…
TransportBar.tsx      â†’ 0 errores âœ…
```

## ğŸ§ª CHECKLIST DE TESTING

- [ ] Click botÃ³n RACK en TransportBar â†’ Live Rack aparece a la derecha
- [ ] Click RACK de nuevo â†’ Rack desaparece
- [ ] ContextualDataSheet NO visible cuando rack abierto
- [ ] ContextualDataSheet SÃ visible cuando rack cerrado y clip seleccionado
- [ ] Seleccionar fixtures en Stage â†’ aparecen en el rack con controles
- [ ] Intensity slider funciona desde el rack
- [ ] Color picker funciona desde el rack
- [ ] Position XY Pad funciona desde el rack  
- [ ] Beam section funciona desde el rack
- [ ] Accordion exclusive mode funciona (solo 1 secciÃ³n abierta)
- [ ] UNLOCK ALL funciona desde el rack
- [ ] BotÃ³n â–¶ collapse â†’ rack se contrae a 32px vertical
- [ ] Click en strip colapsado â†’ rack se expande
- [ ] Badge con nÃºmero de fixtures seleccionados visible
- [ ] isRecording â†’ rack se muestra automÃ¡ticamente (sin tocar RACK button)
- [ ] Scroll funciona en rack-body cuando hay muchas secciones
- [ ] Layout no se rompe en pantallas < 1200px

## ğŸ”® SIGUIENTE: WAVE 2046 Phase 3
**"LA FUSIÃ“N"** â€” Bidireccionalidad completa: seleccionar fixture en Stage â†’ 
rack se enfoca. Cambiar valor en rack â†’ Stage refleja al instante. 
PropertyPanel contextual con DMX address preview.

---
*PunkOpus â€” El injerto prendiÃ³. TheProgrammer ahora vive en dos mundos.*
