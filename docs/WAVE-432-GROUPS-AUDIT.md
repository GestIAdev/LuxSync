# üîç WAVE 432 GROUPS AUDIT - REPORTE DE RECONOCIMIENTO

**Fecha**: 2026-01-14
**Auditor**: PunkOpus

---

## üìä VEREDICTO EJECUTIVO

### ‚úÖ LOS GRUPOS EXISTEN Y EST√ÅN LISTOS

El sistema de grupos est√° **completamente implementado** en el backend. Solo falta la UI.

---

## üóÇÔ∏è ESTRUCTURA DE DATOS

### ShowFileV2 (`src/core/stage/ShowFileV2.ts`)

```typescript
interface ShowFileV2 {
  // ... metadata, stage, fixtures ...
  
  /** Fixture groups - ¬°YA EXISTE! */
  groups: FixtureGroup[]
  
  // ... scenes, dmx, audio ...
}
```

### FixtureGroup (`ShowFileV2.ts` l√≠nea ~320)

```typescript
interface FixtureGroup {
  id: string           // Identificador √∫nico
  name: string         // Nombre del usuario (e.g., "Front Wash")
  fixtureIds: string[] // Array de IDs de fixtures
  color: string        // Color para visualizaci√≥n (hex)
  hotkey?: string      // Atajo de teclado (e.g., "1", "F1")
  isSystem: boolean    // ¬øEs auto-generado? (All, By Zone)
  order: number        // Orden en UI
}
```

---

## üéØ ZONAS (FixtureZone)

Las zonas son **propiedades de cada fixture**, no entidades separadas:

```typescript
// ShowFileV2.ts l√≠nea ~195
type FixtureZone = 
  | 'stage-left'    | 'stage-right'   | 'stage-center'
  | 'ceiling-front' | 'ceiling-back'  | 'ceiling-left' 
  | 'ceiling-right' | 'ceiling-center'
  | 'floor-front'   | 'floor-back'
  | 'truss-1'       | 'truss-2'       | 'truss-3'
  | 'custom'        | 'unassigned'
```

### Selector de Zonas (`stageStore.ts` l√≠nea ~689)

```typescript
export const selectFixturesByZone = (zone: FixtureZone) => (state: StageStore) =>
  state.fixtures.filter(f => f.zone === zone)
```

---

## üõ†Ô∏è ACCIONES DISPONIBLES EN stageStore

El store ya tiene **todas las acciones necesarias**:

| Acci√≥n | Descripci√≥n | L√≠nea |
|--------|-------------|-------|
| `createGroup(name, fixtureIds)` | Crea grupo nuevo | ~148 |
| `deleteGroup(id)` | Elimina grupo | ~151 |
| `addToGroup(groupId, fixtureId)` | A√±ade fixture a grupo | ~154 |
| `removeFromGroup(groupId, fixtureId)` | Quita fixture de grupo | ~157 |
| `updateGroup(id, updates)` | Actualiza propiedades | ~160 |

---

## üíæ PERSISTENCIA

### ¬øSe guardan los grupos?

**S√ç** - Los grupos se persisten en el archivo `.luxshow`:

```
%APPDATA%/LuxSync/shows/{name}.luxshow
```

La estructura del archivo incluye el array `groups` al mismo nivel que `fixtures` y `scenes`.

### ¬øEl Builder (StageConstructor) los guarda?

**PARCIALMENTE** - El StageConstructor usa `stageStore.createGroup()` para crear grupos, pero la UI de creaci√≥n de grupos desde el Builder no est√° implementada visualmente.

---

## üìã RECOMENDACI√ìN PARA WAVE 432

### Lo que YA est√° listo:
1. ‚úÖ Modelo de datos (`FixtureGroup`)
2. ‚úÖ Persistencia (se guarda en `.luxshow`)
3. ‚úÖ Acciones del Store (CRUD completo)
4. ‚úÖ Selector por zonas (`selectFixturesByZone`)

### Lo que FALTA para la pesta√±a GROUPS:
1. ‚è≥ **GroupsPanel.tsx** - UI de la pesta√±a
2. ‚è≥ **GroupCard.tsx** - Card individual de cada grupo
3. ‚è≥ **Auto-grupos por zona** - Generar grupos "Front", "Back", etc. desde zonas
4. ‚è≥ **Selecci√≥n m√∫ltiple** - Para crear grupos desde TheProgrammer

---

## üèóÔ∏è PROPUESTA DE IMPLEMENTACI√ìN

### Fase 1: Auto-Grupos por Zona
```typescript
// En el panel GROUPS
const zoneGroups = useMemo(() => {
  const zones = ['ceiling-front', 'ceiling-back', 'stage-left', 'stage-right']
  return zones.map(zone => ({
    id: `auto-${zone}`,
    name: zone.replace('-', ' ').toUpperCase(),
    fixtureIds: fixtures.filter(f => f.zone === zone).map(f => f.id),
    isSystem: true
  }))
}, [fixtures])
```

### Fase 2: Grupos de Usuario
- Drag & drop fixtures a grupo
- Crear grupo desde selecci√≥n m√∫ltiple
- Hotkeys configurables (1-9, F1-F12)

---

## üé¨ CONCLUSI√ìN

**NO hay que crear nada en el backend.** El sistema de grupos est√° listo, dormido pero funcional. Solo necesitamos despertar la UI.

> "El c√≥digo exist√≠a, solo esperaba que lo vi√©ramos." - PunkOpus

---

*Generated by WAVE 432 Audit - LuxSync*
