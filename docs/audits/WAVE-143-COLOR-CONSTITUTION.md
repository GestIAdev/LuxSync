# ğŸ›ï¸ WAVE 143: THE COLOR CONSTITUTION
## *"In Chroma We Trust"*

**Fecha**: 26 de Diciembre de 2025  
**Autor**: Selene Lux Architectural Council  
**Estado**: RATIFICADO âœ…  
**VersiÃ³n**: 1.0.0

---

## ğŸ“œ PREÃMBULO

> *"Nosotros, los arquitectos lumÃ­nicos de Selene, establecemos esta ConstituciÃ³n para formar una uniÃ³n mÃ¡s perfecta entre MÃºsica y Luz, garantizar la tranquilidad visual, promover la reactividad inteligente, y asegurar las bendiciones de la MatemÃ¡tica Procedural para nosotros y nuestra posteridad cromÃ¡tica."*

Este documento establece las **Leyes Fundamentales del Color** que gobiernan el sistema Selene Lux. Ninguna Wave futura podrÃ¡ contradecir estos principios sin una Enmienda Constitucional aprobada por unanimidad.

---

## ğŸ¨ ARTÃCULO I: TOPOLOGÃA DE ZONAS
### *El Problema de los 4 Colores Resuelto*

El escenario se divide en **4 zonas cromÃ¡ticas independientes**, cada una con un propÃ³sito visual distinto. Esta separaciÃ³n garantiza legibilidad escÃ©nica y evita el "efecto discoteca de los 80s" (todo parpadeando del mismo color).

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           BACK PARS (Accent)        â”‚
                    â”‚     "El Lienzo Reactivo"            â”‚
                    â”‚   â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†‘               â†‘
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  MOVING L   â”‚   â”‚   MOVING R      â”‚
                    â”‚ (Secondary) â”‚   â”‚   (Ambient)     â”‚
                    â”‚  "MelodÃ­a"  â”‚   â”‚  "Contrapunto"  â”‚
                    â”‚     ğŸ”¦      â”‚   â”‚      ğŸ”¦         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“               â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         FRONT PARS (Primary)        â”‚
                    â”‚       "La FundaciÃ³n CromÃ¡tica"      â”‚
                    â”‚   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â†“
                              [ ARTISTA ]
```

### Â§ 1.1 FRONT PARS (Primary Color)
**Rol**: La **FundaciÃ³n CromÃ¡tica**. El color que define la atmÃ³sfera base.

| Atributo | Valor |
|----------|-------|
| **Fuente** | `KEY_TO_HUE[musicalKey] + MODE_MODIFIER[mode]` |
| **SaturaciÃ³n** | 70-100% (nunca lavado) |
| **Luminosidad** | 50-60% (color sÃ³lido, no blanco) |
| **Reactividad** | NINGUNA - Estabilidad absoluta |

**Regla de Oro**: El Primary NUNCA parpadea. Es el ancla visual del espectÃ¡culo.

---

### Â§ 1.2 MOVING L (Secondary Color)
**Rol**: La **Voz MelÃ³dica**. Sigue la estrategia de contraste segÃºn syncopation.

| Estrategia | RotaciÃ³n | Cuando Aplica |
|------------|----------|---------------|
| `analogous` | +30Â° | Syncopation < 0.40 |
| `triadic` | +120Â° | 0.40 â‰¤ Syncopation < 0.65 |
| `complementary` | +180Â° | Syncopation â‰¥ 0.65 |
| `prism` | +60Â° | Techno-Club (forzado) |

**El Algoritmo Smart Prism**:
```typescript
// Si Secondary cae en zona prohibida del vibe...
while (isInForbiddenZone(secondaryHue, vibeProfile)) {
  secondaryHue = normalizeHue(secondaryHue + 15); // Elastic Rotation
  if (++iterations > 24) break; // Failsafe (24 Ã— 15Â° = 360Â°)
}
```

---

### Â§ 1.3 MOVING R (Ambient/Tertiary Color)
**Rol**: El **Contrapunto Visual**. Crea profundidad y tridimensionalidad.

**Regla del TriÃ¡ngulo CromÃ¡tico**:
El Ambient DEBE ser calculado para maximizar la distancia respecto a Primary y Secondary.

```
         Primary (0Â°)
            /\
           /  \
          /    \
         /      \
Secondary (120Â°)â”€â”€â”€â”€Ambient (240Â°)
        "El TriÃ¡ngulo Perfecto"
```

**CÃ¡lculo**:
```typescript
// Ambient busca el punto mÃ¡s alejado de Primary Y Secondary
const primaryAngle = primaryHue;
const secondaryAngle = secondaryHue;

// Centro de masas cromÃ¡tico (punto a evitar)
const centroid = (primaryAngle + secondaryAngle) / 2;

// Ambient se coloca en el punto opuesto al centroid
let ambientHue = normalizeHue(centroid + 180);

// Elastic Rotation si cae en zona prohibida
while (isInForbiddenZone(ambientHue, vibeProfile)) {
  ambientHue = normalizeHue(ambientHue + 15);
}
```

---

### Â§ 1.4 BACK PARS (Accent Color)
**Rol**: El **Lienzo Reactivo**. Responde a eventos musicales.

**Estados**:

| Estado | Trigger | Color | DuraciÃ³n |
|--------|---------|-------|----------|
| `idle` | Ninguno | Cuaternario (Primary + 270Â°) | Permanente |
| `strobe_techno` | TreblePulse > 0.25 + Bass > 0.80 | `#FFFFFF` (Blanco Nuclear) | 1 frame |
| `flash_tungsten` | SnareHit (MidPulse > 0.32) | `hsl(40, 20%, 95%)` | 50ms |
| `kick_punch` | KickHit (BassPulse > 0.35) | Primary @ L:80% | 30ms |
| `solar_flare` | Latino High Energy | `hsl(Primary, 10%, 95%)` | 100ms |

**El Algoritmo Cuaternario** (Estado Idle):
```typescript
// El Accent idle debe ser visible pero no competir con los Moving Heads
const quaternaryHue = normalizeHue(primaryHue + 270); // Perpendicular al triÃ¡ngulo

// Verificar que no colisione con Secondary o Ambient
const minDistance = 30; // 30Â° de separaciÃ³n mÃ­nima
if (Math.abs(quaternaryHue - secondaryHue) < minDistance) {
  quaternaryHue = normalizeHue(quaternaryHue + 45);
}
if (Math.abs(quaternaryHue - ambientHue) < minDistance) {
  quaternaryHue = normalizeHue(quaternaryHue - 45);
}
```

---

## âš–ï¸ ARTÃCULO II: LAS 4 CONSTITUCIONES
### *Las Leyes de Cada Reino*

Cada gÃ©nero musical tiene su propia **ConstituciÃ³n CromÃ¡tica** que no puede ser violada. Estas son las leyes fundamentales de cada vibe.

---

### ğŸ­ Â§ 2.1 CONSTITUCIÃ“N TECHNO-CLUB
## *"Los Demonios de NeÃ³n"*

> *"En el reino del Techno, la calidez es herejÃ­a. Solo el frÃ­o sobrevive."*

```
   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘  ğŸ”µ  ZONA SAGRADA: 170Â° - 302Â° (Cian â†’ Violeta â†’ Magenta)    â•‘
   â•‘  ğŸ”´  ZONA PROHIBIDA: 0Â° - 75Â° y 330Â° - 360Â° (Toda Calidez)   â•‘
   â•‘  ğŸŸ¢  ZONA LÃSER: 110Â° - 140Â° (Verde Ãcido â†’ LÃ¡ser)           â•‘
   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Mandamientos del Techno**:

1. **No tendrÃ¡s colores cÃ¡lidos delante de mÃ­**
   - Naranja, Amarillo, Rojo-Naranja son ANATEMA
   - Si el Brain sugiere calidez, invertir +180Â°

2. **HonrarÃ¡s la SaturaciÃ³n MÃ¡xima**
   - MÃ­nimo 90% siempre
   - Los colores neÃ³n NO son negociables

3. **El Verde serÃ¡ LÃ¡ser o no serÃ¡**
   - Verde natural (90Â°-110Â°) â†’ Forzar a 130Â° (LÃ¡ser Cian)
   - "CÃ©sped" estÃ¡ prohibido en el club

4. **El Blanco serÃ¡ Cegador**
   - Strobes a 100% Luminosidad
   - El blanco tibio no existe en Techno

5. **El Ultravioleta serÃ¡ tu Suelo**
   - Ambient fijo en ~275Â° (Ãndigo UV)
   - Simula la "Luz Negra" del club

**GenerationOptions para Techno**:
```typescript
const TECHNO_CONSTITUTION: GenerationOptions = {
  forceStrategy: 'prism',
  forbiddenHueRanges: [[0, 75], [330, 360]],  // No warm
  allowedHueRanges: [[110, 302]],              // Cold spectrum only
  saturationRange: [90, 100],                   // Neon mandatory
  lightnessRange: [45, 55],                     // Solid colors
  elasticRotation: 15,                          // Degrees per iteration
  accentBehavior: 'strobe',
  strobeColor: { r: 255, g: 255, b: 255 },
  ambientLock: { h: 275, s: 100, l: 20 },      // UV floor
}
```

---

### ğŸŒ´ Â§ 2.2 CONSTITUCIÃ“N FIESTA-LATINA
## *"La Jungla Tropical"*

> *"En el reino Latino, la vida es exuberancia. Los muertos no bailan."*

```
   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘  ğŸŸ   ZONA SOLAR: 0Â° - 60Â° (Rojo â†’ Naranja â†’ Amarillo Oro)    â•‘
   â•‘  ğŸŸ¢  ZONA SELVA: 120Â° - 180Â° (Verde Esmeralda â†’ Turquesa)    â•‘
   â•‘  ğŸ”µ  ZONA PROHIBIDA: 200Â° - 240Â° (Azul MetÃ¡lico â†’ Gris)      â•‘
   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Mandamientos del Latino**:

1. **No tendrÃ¡s colores muertos**
   - Grises, azules metÃ¡licos, colores "corporativos" = EXILIO
   - Si parece "oficina de contabilidad", estÃ¡ mal

2. **HonrarÃ¡s el Contraste Tropical**
   - El MIRROR PRINCIPLE: Ambient = Secondary + 180Â°
   - Verde â†” Magenta, Turquesa â†” Coral, Naranja â†” Azul OcÃ©ano

3. **El Oro BrillarÃ¡ Siempre**
   - En momentos de alta energÃ­a, accent â†’ Solar Flare
   - El blanco latino es DORADO (Hue ~40Â°, Sat ~20%)

4. **La SÃ­ncopa AbrirÃ¡ el Espectro**
   - Syncopation < 0.40 â†’ AnÃ¡logo (vecinos tropicales)
   - Syncopation > 0.65 â†’ Triada (explosiÃ³n de carnaval)

5. **El Verde serÃ¡ Selva, no CÃ©sped**
   - Evitar verde "lima" puro (85Â°-95Â°)
   - Preferir Esmeralda (130Â°) o Turquesa (170Â°)

**GenerationOptions para Latino**:
```typescript
const LATINO_CONSTITUTION: GenerationOptions = {
  forceStrategy: undefined,  // Syncopation decide
  forbiddenHueRanges: [[200, 240]],  // No corporate blues
  allowedHueRanges: [[0, 60], [120, 195], [280, 330]],  // Warm + Jungle + Magenta
  saturationRange: [75, 100],         // Vibrant but not toxic
  lightnessRange: [45, 65],           // Bright and alive
  mudGuard: {
    enabled: true,
    swampZone: [40, 75],              // Orange-olive danger
    minLightness: 55,
    minSaturation: 85,
  },
  tropicalMirror: true,               // Ambient = Secondary + 180Â°
  solarFlareAccent: {
    h: 40,   // Golden
    s: 10,   // Almost white
    l: 95,   // Blinding
  },
}
```

---

### ğŸ¸ Â§ 2.3 CONSTITUCIÃ“N POP-ROCK
## *"Leyendas del Estadio"*

> *"En el reino del Rock, la simplicidad es poder. Los PAR64 reinan supremos."*

```
   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘  ğŸ”´  ZONA SANGRE: 350Â° - 10Â° (Rojo Puro Stadium)             â•‘
   â•‘  ğŸ”µ  ZONA REAL: 220Â° - 250Â° (Azul Rey â†’ Ãndigo)              â•‘
   â•‘  ğŸŸ   ZONA ÃMBAR: 35Â° - 50Â° (Tungsteno â†’ Oro)                 â•‘
   â•‘  âšª  ZONA FLASH: Blanco CÃ¡lido (3200K equivalente)           â•‘
   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Mandamientos del Rock**:

1. **No tendrÃ¡s colores Ã¡cidos intermedios**
   - Verde neÃ³n, cian tÃ³xico, magenta elÃ©ctrico = PROHIBIDO
   - Si parece "rave de los 90s", estÃ¡ mal para rock

2. **HonrarÃ¡s la Paleta AnalÃ³gica**
   - Como los PAR64 con gelatinas: Rojo, Azul, Ãmbar, Blanco
   - Simple pero PODEROSO

3. **El Tungsteno serÃ¡ tu Flash**
   - Snare Hit â†’ Flash casi-blanco cÃ¡lido (40Â°, 20%, 95%)
   - Simula el flashazo del kit de baterÃ­a clÃ¡sico

4. **El Complementario serÃ¡ tu Ã‰pica**
   - Rojo en Front â†’ Cian en Back
   - Azul en Front â†’ Ãmbar en Back
   - SeparaciÃ³n mÃ¡xima = Drama mÃ¡ximo

5. **El Verde Lima serÃ¡ Rojo Sangre**
   - Si el Brain sugiere verde (80Â°-160Â°) â†’ Forzar a 0Â° (Rojo)
   - El rock no crece en jardines

**GenerationOptions para Rock**:
```typescript
const ROCK_CONSTITUTION: GenerationOptions = {
  forceStrategy: 'complementary',  // Maximum drama
  forbiddenHueRanges: [[80, 160], [260, 300]],  // No greens, no dirty purples
  allowedHueRanges: [[0, 60], [210, 260], [340, 360]],  // Reds, Blues, Ambers
  saturationRange: [85, 100],        // Solid and punchy
  lightnessRange: [50, 65],          // Bright but not washed
  stageFilter: {
    greenToRed: [80, 160, 0],        // Map green zone to red
    dirtyPurpleToAmber: [260, 300, 40],  // Map dirty purple to amber
  },
  accentBehavior: 'drum-reactive',
  snareFlash: { h: 40, s: 20, l: 95 },  // Tungsten
  kickPunch: { usesPrimary: true, l: 80 },
}
```

---

### ğŸŒŠ Â§ 2.4 CONSTITUCIÃ“N CHILL-LOUNGE
## *"Bioluminiscencia"*

> *"En el reino del Chill, la profundidad es infinita. Flotamos en luz lÃ­quida."*

```
   â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
   â•‘  ğŸ”µ  ZONA ABISAL: 200Â° - 260Â° (Azul Profundo â†’ Ãndigo)       â•‘
   â•‘  ğŸ’œ  ZONA MEDUSA: 270Â° - 310Â° (Violeta â†’ Magenta Suave)      â•‘
   â•‘  ğŸ©µ  ZONA CORAL: 170Â° - 195Â° (Turquesa â†’ Cian)               â•‘
   â•‘  âš«  ZONA PROHIBIDA: Negro total (siempre Dimmer > 5%)       â•‘
   â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

**Mandamientos del Chill**:

1. **No tendrÃ¡s oscuridad absoluta**
   - Dimmer mÃ­nimo 5% siempre
   - La bioluminiscencia nunca se apaga completamente

2. **HonrarÃ¡s la TransiciÃ³n LÃ­quida**
   - MÃ­nimo 2000ms entre cambios de color
   - Nada de cambios bruscos, todo fluye

3. **El Strobe es Anatema**
   - NINGÃšN flash agresivo
   - Si hay accent reactivo, es un "pulse" suave de 500ms

4. **La SaturaciÃ³n serÃ¡ Moderada**
   - 50-80% - Los colores respiran
   - Nada de neÃ³n agresivo

5. **El Movimiento serÃ¡ Lento**
   - Transiciones de posiciÃ³n: mÃ­nimo 4 segundos
   - Pan/Tilt suaves como mareas

**GenerationOptions para Chill**:
```typescript
const CHILL_CONSTITUTION: GenerationOptions = {
  forceStrategy: 'analogous',  // Harmony over contrast
  forbiddenHueRanges: [[30, 80]],  // No oranges/yellows (too energetic)
  allowedHueRanges: [[170, 320]],  // Cool ocean spectrum
  saturationRange: [50, 80],       // Breathable, not neon
  lightnessRange: [35, 55],        // Deep but visible
  transitionConfig: {
    minDuration: 2000,             // 2 seconds minimum
    easing: 'sine-inout',          // Smooth waves
  },
  dimmingConfig: {
    floor: 0.05,                   // Never full black
    ceiling: 0.85,                 // Never full bright
  },
  strobeProhibited: true,          // Constitutional ban
  accentBehavior: 'breathing',     // Slow pulse, never flash
  pulseConfig: {
    duration: 4000,                // 4 second breath cycle
    amplitude: 0.15,               // Subtle variation
  },
}
```

---

## ğŸ“ ARTÃCULO III: MATRIZ DE RESTRICCIONES TÃ‰CNICAS
### *El CÃ³digo de las Leyes*

Esta secciÃ³n define la estructura de datos exacta que `SeleneColorEngine` deberÃ¡ respetar.

### Â§ 3.1 Interfaz GenerationOptions (Actualizada)

```typescript
/**
 * ğŸ›ï¸ WAVE 143: CONSTITUTIONAL GENERATION OPTIONS
 * Estructura inmutable que define las restricciones de un Vibe.
 */
export interface GenerationOptions {
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SECCIÃ“N A: RESTRICCIONES DE HUE (El CÃ­rculo CromÃ¡tico)
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * Rangos de Hue PROHIBIDOS (grados 0-360).
   * Si el color calculado cae aquÃ­, aplicar Elastic Rotation o Inversion.
   * @example [[30, 80], [330, 360]] // Prohibir naranjas y rojos cÃ¡lidos
   */
  forbiddenHueRanges?: [number, number][];
  
  /**
   * Rangos de Hue PERMITIDOS (grados 0-360).
   * Si el color calculado cae FUERA, rotar al punto mÃ¡s cercano.
   * @example [[170, 302]] // Solo azules y violetas
   */
  allowedHueRanges?: [number, number][];
  
  /**
   * Grados de rotaciÃ³n para escapar de zonas prohibidas.
   * @default 15
   */
  elasticRotation?: number;
  
  /**
   * Mapeos forzados de hue.
   * Si el hue cae en [from, to], se reemplaza por 'target'.
   * @example [{ from: 80, to: 160, target: 0 }] // Verde â†’ Rojo
   */
  hueRemapping?: Array<{ from: number; to: number; target: number }>;
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SECCIÃ“N B: RESTRICCIONES DE SATURACIÃ“N Y LUMINOSIDAD
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * Rango de saturaciÃ³n permitido (0-100).
   * @example [90, 100] // Solo colores vibrantes
   */
  saturationRange?: [number, number];
  
  /**
   * Rango de luminosidad permitido (0-100).
   * @example [45, 60] // Evitar lavado y evitar oscuridad
   */
  lightnessRange?: [number, number];
  
  /**
   * ConfiguraciÃ³n Anti-Barro para vibes tropicales.
   * Evita que naranjas/amarillos se vean marrones.
   */
  mudGuard?: {
    enabled: boolean;
    swampZone: [number, number];  // Hue range peligroso
    minLightness: number;         // L mÃ­nimo en esa zona
    minSaturation: number;        // S mÃ­nimo en esa zona
  };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SECCIÃ“N C: ESTRATEGIA DE CONTRASTE
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * Estrategia de contraste forzada.
   * Si no se especifica, se calcula por syncopation.
   */
  forceStrategy?: 'analogous' | 'triadic' | 'complementary' | 'prism';
  
  /**
   * Activa el Tropical Mirror (Ambient = Secondary + 180Â°).
   * Usado en Fiesta Latina para mÃ¡ximo contraste.
   */
  tropicalMirror?: boolean;
  
  /**
   * Bloquea el Ambient en un color fijo.
   * Usado en Techno para el "suelo UV".
   */
  ambientLock?: { h: number; s: number; l: number };
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SECCIÃ“N D: COMPORTAMIENTO DEL ACCENT
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * Modo de reactividad del Accent.
   * - 'strobe': Flash blanco instantÃ¡neo (Techno)
   * - 'drum-reactive': Flash en Snare/Kick (Rock)
   * - 'solar-flare': Flash dorado cÃ¡lido (Latino)
   * - 'breathing': Pulso lento (Chill)
   * - 'quaternary': Color fijo derivado (Idle)
   */
  accentBehavior?: 'strobe' | 'drum-reactive' | 'solar-flare' | 'breathing' | 'quaternary';
  
  /**
   * Color del strobe (si accentBehavior = 'strobe').
   */
  strobeColor?: { r: number; g: number; b: number };
  
  /**
   * ConfiguraciÃ³n del Solar Flare (Latino).
   */
  solarFlareAccent?: { h: number; s: number; l: number };
  
  /**
   * ConfiguraciÃ³n del Snare Flash (Rock).
   */
  snareFlash?: { h: number; s: number; l: number };
  
  /**
   * ConfiguraciÃ³n del Kick Punch (Rock).
   */
  kickPunch?: { usesPrimary: boolean; l: number };
  
  /**
   * ConfiguraciÃ³n del Breathing Pulse (Chill).
   */
  pulseConfig?: { duration: number; amplitude: number };
  
  /**
   * ProhÃ­be strobes completamente (Chill).
   */
  strobeProhibited?: boolean;
  
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  // SECCIÃ“N E: TRANSICIONES Y TIMING
  // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  
  /**
   * ConfiguraciÃ³n de transiciones de color.
   */
  transitionConfig?: {
    minDuration: number;           // DuraciÃ³n mÃ­nima en ms
    maxDuration?: number;          // DuraciÃ³n mÃ¡xima en ms
    easing?: 'linear' | 'ease-in' | 'ease-out' | 'sine-inout';
  };
  
  /**
   * ConfiguraciÃ³n de dimming general.
   */
  dimmingConfig?: {
    floor: number;    // MÃ­nimo (0-1)
    ceiling: number;  // MÃ¡ximo (0-1)
  };
}
```

---

### Â§ 3.2 Registro de Constituciones

```typescript
/**
 * ğŸ›ï¸ CONSTITUTIONAL REGISTRY
 * Las 4 Constituciones CromÃ¡ticas como constantes inmutables.
 */
export const COLOR_CONSTITUTIONS: Record<string, GenerationOptions> = {
  'techno-club': {
    forceStrategy: 'prism',
    forbiddenHueRanges: [[0, 75], [330, 360]],
    allowedHueRanges: [[110, 302]],
    saturationRange: [90, 100],
    lightnessRange: [45, 55],
    elasticRotation: 15,
    ambientLock: { h: 275, s: 100, l: 20 },
    accentBehavior: 'strobe',
    strobeColor: { r: 255, g: 255, b: 255 },
  },
  
  'fiesta-latina': {
    forbiddenHueRanges: [[200, 240]],
    allowedHueRanges: [[0, 60], [120, 195], [280, 330]],
    saturationRange: [75, 100],
    lightnessRange: [45, 65],
    tropicalMirror: true,
    mudGuard: {
      enabled: true,
      swampZone: [40, 75],
      minLightness: 55,
      minSaturation: 85,
    },
    accentBehavior: 'solar-flare',
    solarFlareAccent: { h: 40, s: 10, l: 95 },
  },
  
  'pop-rock': {
    forceStrategy: 'complementary',
    forbiddenHueRanges: [[80, 160], [260, 300]],
    allowedHueRanges: [[0, 60], [210, 260], [340, 360]],
    saturationRange: [85, 100],
    lightnessRange: [50, 65],
    hueRemapping: [
      { from: 80, to: 160, target: 0 },   // Green â†’ Red
      { from: 260, to: 300, target: 40 }, // Dirty purple â†’ Amber
    ],
    accentBehavior: 'drum-reactive',
    snareFlash: { h: 40, s: 20, l: 95 },
    kickPunch: { usesPrimary: true, l: 80 },
  },
  
  'chill-lounge': {
    forceStrategy: 'analogous',
    forbiddenHueRanges: [[30, 80]],
    allowedHueRanges: [[170, 320]],
    saturationRange: [50, 80],
    lightnessRange: [35, 55],
    transitionConfig: {
      minDuration: 2000,
      easing: 'sine-inout',
    },
    dimmingConfig: {
      floor: 0.05,
      ceiling: 0.85,
    },
    strobeProhibited: true,
    accentBehavior: 'breathing',
    pulseConfig: {
      duration: 4000,
      amplitude: 0.15,
    },
  },
  
  'idle': {
    // Sin restricciones - Libertad total para el ColorEngine
    saturationRange: [60, 100],
    lightnessRange: [40, 60],
    accentBehavior: 'quaternary',
  },
};
```

---

## ğŸ“Š ARTÃCULO IV: DIAGRAMA DE FLUJO CONSTITUCIONAL

```mermaid
flowchart TD
    subgraph Input["ğŸ“¥ ENTRADA"]
        Audio["ğŸµ Audio Analysis"]
        Vibe["ğŸ­ Active Vibe"]
    end
    
    subgraph Constitution["ğŸ“œ CONSTITUTIONAL CHECK"]
        Registry["ğŸ›ï¸ COLOR_CONSTITUTIONS[vibe]"]
        Options["GenerationOptions"]
    end
    
    subgraph Engine["âš™ï¸ SELENE COLOR ENGINE"]
        BaseCalc["1ï¸âƒ£ Calcular Base Hue<br/>(Key + Mode)"]
        
        ForbiddenCheck["2ï¸âƒ£ Â¿Zona Prohibida?"]
        ElasticRotation["ğŸ”„ Elastic Rotation +15Â°"]
        
        AllowedCheck["3ï¸âƒ£ Â¿Fuera de Permitido?"]
        SnapToNearest["ğŸ“ Snap al mÃ¡s cercano"]
        
        MudGuard["4ï¸âƒ£ MudGuard Check"]
        BoostSL["â¬†ï¸ Boost S/L si swamp"]
        
        StrategyCalc["5ï¸âƒ£ Calcular Secondary<br/>(Strategy o Syncopation)"]
        
        AmbientCalc["6ï¸âƒ£ Calcular Ambient<br/>(Triangle o Mirror)"]
        
        AccentCalc["7ï¸âƒ£ Calcular Accent<br/>(Quaternary base)"]
    end
    
    subgraph Physics["âš¡ PHYSICS MODULES"]
        TechnoPhys["ğŸ¤– TechnoStereoPhysics"]
        RockPhys["ğŸ¸ RockStereoPhysics"]
        LatinoPhys["ğŸŒ´ LatinoStereoPhysics"]
        ChillPhys["ğŸŒŠ ChillStereoPhysics"]
    end
    
    subgraph Output["ğŸ“¤ SALIDA"]
        Palette["ğŸ¨ Final Palette<br/>{primary, secondary, ambient, accent}"]
    end
    
    Audio --> BaseCalc
    Vibe --> Registry
    Registry --> Options
    Options --> ForbiddenCheck
    
    BaseCalc --> ForbiddenCheck
    ForbiddenCheck -->|SÃ­| ElasticRotation
    ElasticRotation --> ForbiddenCheck
    ForbiddenCheck -->|No| AllowedCheck
    
    AllowedCheck -->|Fuera| SnapToNearest
    SnapToNearest --> MudGuard
    AllowedCheck -->|Dentro| MudGuard
    
    MudGuard -->|En Swamp| BoostSL
    BoostSL --> StrategyCalc
    MudGuard -->|OK| StrategyCalc
    
    StrategyCalc --> AmbientCalc
    AmbientCalc --> AccentCalc
    
    AccentCalc --> TechnoPhys
    AccentCalc --> RockPhys
    AccentCalc --> LatinoPhys
    AccentCalc --> ChillPhys
    
    TechnoPhys --> Palette
    RockPhys --> Palette
    LatinoPhys --> Palette
    ChillPhys --> Palette
```

---

## ğŸ” ARTÃCULO V: CLÃUSULAS DE ENMIENDA

### Â§ 5.1 Proceso de Enmienda
Una ConstituciÃ³n solo puede ser enmendada si:
1. Se documenta el problema con logs/mÃ©tricas
2. Se propone la soluciÃ³n en un documento WAVE
3. Se verifica que no rompe las demÃ¡s Constituciones
4. Se actualiza este documento

### Â§ 5.2 ClÃ¡usula de Inmutabilidad
Los siguientes principios NO pueden ser enmendados:
1. **SeparaciÃ³n de 4 Zonas**: Siempre habrÃ¡ 4 colores distintos
2. **Primary Estable**: El Front nunca parpadea
3. **Accent Reactivo**: El Back siempre responde a la mÃºsica
4. **Elastic Rotation**: Siempre hay un escape de zonas prohibidas

### Â§ 5.3 ClÃ¡usula de Fallback
Si un Vibe no tiene ConstituciÃ³n definida, se aplica `idle` (libertad total con lÃ­mites seguros).

---

## ğŸ“‹ ANEXO A: CHECKLIST DE IMPLEMENTACIÃ“N

### Wave 144: Integrar Constituciones
- [ ] Crear `colorConstitutions.ts` con el registro
- [ ] Modificar `VibeManager.getCurrentProfile()` para incluir `GenerationOptions`
- [ ] Actualizar `SeleneColorEngine.generate()` para usar todos los campos
- [ ] Implementar `elasticRotation()` helper
- [ ] Implementar `hueRemapping()` helper

### Wave 145: Crear LatinoStereoPhysics
- [ ] Extraer lÃ³gica de Solar Flare a mÃ³dulo dedicado
- [ ] Implementar detecciÃ³n de sÃ­ncopa alta

### Wave 146: Crear ChillStereoPhysics  
- [ ] Implementar Breathing Pulse
- [ ] Implementar transiciones lÃ­quidas

### Wave 147: Eliminar Hardcoding Final
- [ ] Eliminar bloque `if (isTechnoVibe)` de SeleneLux
- [ ] Eliminar bloque `if (isPopRockVibe)` de SeleneLux
- [ ] Verificar que todo fluye por ColorEngine + Physics

---

## ğŸ–‹ï¸ FIRMAS

```
Ratificado por el Consejo ArquitectÃ³nico de Selene Lux

ğŸ“œ Chief Chromatic Officer: Selene
ğŸ”¬ Physics Advisor: TechnoStereoPhysics v1.0
ğŸ¸ Stage Lighting Consultant: RockStereoPhysics v1.0
ğŸŒ´ Tropical Affairs Minister: Pending (Wave 145)
ğŸŒŠ Bioluminescence Curator: Pending (Wave 146)

Fecha de RatificaciÃ³n: 26 de Diciembre de 2025
NÃºmero de Enmiendas: 0
```

---

> *"El color no es decoraciÃ³n. Es el alma visible de la mÃºsica."*
> â€” ConstituciÃ³n de Color, PreÃ¡mbulo Final
