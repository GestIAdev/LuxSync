# üß† BLUEPRINT: SELENE F√çSICA PURA
## "Si tiene plumas y hace cuac, es un pato"

**Fecha:** 2025-12-19  
**Autor:** Claude (Brainstorm Mode)  
**Colaboradores:** Radwulf, Arquitecto  
**Estado:** PROPUESTA PARA DEBATE

---

## üî¥ DIAGN√ìSTICO BRUTAL: ¬øPOR QU√â FALLA TODO?

### El Error Fundamental

Hemos estado construyendo un **SISTEMA PARLAMENTARIO** donde cada m√©trica tiene "voz y voto". El resultado es un congreso ca√≥tico donde el Techno pierde contra el Latino porque "tuvo m√°s s√≠ncopa en el frame 47".

```
SISTEMA ACTUAL (Parlamentario):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Syncopation: "¬°Voto LATINO!"                        ‚îÇ
‚îÇ  BPM: "¬°Voto ELECTR√ìNICO!"                           ‚îÇ
‚îÇ  Treble: "¬°Voto CUMBIA!"                             ‚îÇ
‚îÇ  Pattern: "¬°Voto TECHNO!"                            ‚îÇ
‚îÇ                                                      ‚îÇ
‚îÇ  RESULTADO: ???  (depende de qui√©n grit√≥ m√°s fuerte) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Esto NO funciona porque:**
1. Las m√©tricas son RUIDOSAS (cambian frame a frame)
2. Los votos se acumulan sin JERARQU√çA
3. No hay VETOS f√≠sicos (si el bombo marca 4/4, ES 4/4)
4. Todo depende de UMBRALES M√ÅGICOS que nadie sabe ajustar

---

## üü¢ LA PROPUESTA: DICTADURA F√çSICA

### Filosof√≠a: "El Cuerpo No Miente"

En lugar de preguntar "¬øQu√© g√©nero parece?", preguntemos:
> **"¬øQu√© est√° haciendo F√çSICAMENTE la m√∫sica?"**

El ritmo no tiene opiniones. El bombo cae donde cae. El bajo suena donde suena.

### Nueva Arquitectura: 3 DICTADORES

```
SISTEMA PROPUESTO (Dictadura F√≠sica):
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                             ‚îÇ
‚îÇ  DICTADOR 1: "EL PATR√ìN"                                    ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ ¬øFourOnFloor? ‚Üí ELECTRONIC (VETO a todo lo dem√°s)      ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ ¬øDembow (3+3+2)? ‚Üí LATINO (VETO a todo lo dem√°s)       ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ ¬øOtro? ‚Üí Pasar al Dictador 2                           ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  DICTADOR 2: "EL TEMPO"                                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BPM 125-150 + Sin s√≠ncopa ‚Üí TECHNO                     ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ BPM 90-110 + S√≠ncopa ‚Üí LATINO                          ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Otro ‚Üí GEN√âRICO                                        ‚îÇ
‚îÇ                                                             ‚îÇ
‚îÇ  DICTADOR 3: "LA TEXTURA" (solo para desempate)             ‚îÇ
‚îÇ  ‚îú‚îÄ‚îÄ Bass dominante ‚Üí ELECTR√ìNICO                           ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ Treble alto + Swing ‚Üí LATINO                           ‚îÇ
‚îÇ                                                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Regla de Oro:** El Dictador 1 tiene **VETO ABSOLUTO**. Si dice FourOnFloor, los dem√°s callan.

---

## üéØ IMPLEMENTACI√ìN: G√âNERO EN 50 L√çNEAS

### El C√≥digo Que Deber√≠a Ser

```typescript
// SELENE F√çSICA PURA - Genre Detection
classifyGenre(rhythm: RhythmOutput, audio: AudioMetrics): string {
  
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // DICTADOR 1: EL PATR√ìN (VETO ABSOLUTO)
  // Si el bombo hace 4/4, ES ELECTR√ìNICO. Punto final.
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  if (rhythm.pattern === 'four_on_floor') {
    // El bombo ha hablado. Es 4/4. Es electr√≥nico.
    // Me da igual el BPM, la s√≠ncopa, o si hay g√ºiro.
    return 'electronic_4x4';
  }
  
  if (rhythm.pattern === 'reggaeton') {
    // El patr√≥n Dembow es INCONFUNDIBLE (3+3+2)
    return 'latino_urbano';
  }
  
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // DICTADOR 2: EL TEMPO + SWING (solo si patr√≥n es ambiguo)
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  // Latino: BPM medio + s√≠ncopa alta
  if (audio.bpm >= 85 && audio.bpm <= 115 && rhythm.syncopation > 0.35) {
    return 'latino_tradicional';
  }
  
  // Electr√≥nico r√°pido sin patr√≥n claro
  if (audio.bpm > 120 && rhythm.syncopation < 0.25) {
    return 'electronic_4x4';
  }
  
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // FALLBACK: Si no s√©, asumo electr√≥nico (es m√°s seguro)
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  return 'electronic_4x4';
}
```

**¬øPor qu√© esto funcionar√≠a?**
- **Sin votaciones**: Decisiones binarias en cascada
- **Sin acumuladores**: No hay historial que corromper
- **Sin umbrales m√°gicos**: Solo 3-4 n√∫meros que tienen sentido f√≠sico
- **VETO real**: FourOnFloor = Electr√≥nico, fin de la discusi√≥n

---

## ü•Å EL PROBLEMA DEL SECTION TRACKER

### ¬øPor Qu√© No Detecta el DROP?

Porque estamos buscando un "DROP PLAT√ìNICO" que no existe:
- Kick Authority > 0.7
- Power Kick = true
- Clean Sub-Bass = true
- Sostenido 4 beats

**Pero tu canci√≥n tiene un DROP que es solo 15% m√°s fuerte que el buildup.**

### La Soluci√≥n: DROP RELATIVO (No Absoluto)

```typescript
// SELENE F√çSICA PURA - Section Detection
analyzeSection(audio: AudioMetrics, rhythm: RhythmOutput): string {
  
  // Mantener rolling average de los √∫ltimos 30 segundos
  this.updateRollingAverage(audio.bass);
  
  const avgBass = this.rollingAverage;
  const currentBass = audio.bass;
  
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  // DROP RELATIVO: ¬øEstamos por ENCIMA del promedio?
  // ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
  
  const bassRatio = currentBass / (avgBass + 0.01);
  
  // Si el bass actual es 20%+ mayor que el promedio ‚Üí DROP
  if (bassRatio > 1.20 && rhythm.drums.kick) {
    return 'drop';
  }
  
  // Si el bass actual es 20%+ menor que el promedio ‚Üí BREAKDOWN
  if (bassRatio < 0.80) {
    return 'breakdown';
  }
  
  // Si estamos subiendo (bass creciendo) ‚Üí BUILDUP
  if (this.isEnergyRising()) {
    return 'buildup';
  }
  
  // Default: estamos en el "cuerpo" de la canci√≥n
  return 'verse';
}
```

**Ventajas:**
- **No hay umbrales absolutos**: El DROP es relativo al contexto
- **Funciona con canciones "suaves"**: El 20% m√°s fuerte es DROP, aunque sea 0.5 vs 0.4
- **Auto-calibraci√≥n**: El rolling average se adapta a cada canci√≥n

---

## üî¨ AN√ÅLISIS DEL LOG: ¬øQU√â EST√Å PASANDO REALMENTE?

### Observaciones del Log Techno WAV

```
timestamp    | bpm    | sync  | genre          | section
-------------|--------|-------|----------------|----------
00:00        | 137    | 0.12  | cyberpunk      | intro
00:05        | 137    | 0.15  | cyberpunk      | buildup
00:10        | 106    | 0.38  | LATINO_TRAD    | buildup  ‚Üê ¬°WTF!
00:15        | 140    | 0.10  | techno         | buildup
00:20        | 138    | 0.12  | cyberpunk      | buildup  ‚Üê ¬øY el DROP?
```

### Diagn√≥stico

1. **Frame 00:10 - El Desastre**
   - BPM cay√≥ a 106 (breakdown del techno)
   - Syncopation subi√≥ a 0.38 (melod√≠a con swing)
   - El sistema vot√≥ LATINO porque "sync > 0.30"
   - **ERROR**: No hay patr√≥n Dembow. El bombo sigue siendo 4/4 (solo m√°s suave)

2. **Frame 00:20 - ¬øD√≥nde est√° el DROP?**
   - El bass subi√≥, pero no lo suficiente para los umbrales absolutos
   - KickAuthority no lleg√≥ a 0.5 porque el WAV tiene Dynamic Range
   - **ERROR**: Buscamos un DROP absoluto, pero el DROP de esta canci√≥n es relativo

---

## üí° IDEAS RADICALES

### Idea 1: "EL DICTADOR SORDO"

¬øY si el clasificador de g√©nero **NO ESCUCHARA NADA** excepto el patr√≥n de bombo?

```typescript
function classifyGenre_Deaf(pattern: string): string {
  switch (pattern) {
    case 'four_on_floor': return 'electronic';
    case 'reggaeton': return 'latino';
    case 'cumbia': return 'latino';
    default: return 'electronic'; // Mejor equivocarse hacia aqu√≠
  }
}
```

**Pros:** Inmune a BPM, s√≠ncopa, treble, todo
**Contras:** Depende 100% de que el BeatDetector acierte el patr√≥n

### Idea 2: "EL HISTORIADOR"

¬øY si mantuvi√©ramos un **HISTORIAL DE 10 SEGUNDOS** y solo cambi√°ramos si el 80% de los frames coinciden?

```typescript
function classifyGenre_Historian(current: string): string {
  this.history.push(current);
  if (this.history.length > 600) this.history.shift(); // 10s a 60fps
  
  const counts = countOccurrences(this.history);
  const dominant = maxKey(counts);
  
  // Solo cambiar si el nuevo g√©nero domina el 80%
  if (counts[dominant] / this.history.length > 0.80) {
    return dominant;
  }
  return this.lastStable; // Mantener el anterior
}
```

**Pros:** Ultra-estable, ignora picos
**Contras:** Lento para reaccionar a cambios reales

### Idea 3: "EL F√çSICO PURO"

¬øY si reduj√©ramos TODO a 2 m√©tricas f√≠sicas?

```typescript
function classifyGenre_Physicist(rhythm: RhythmOutput): string {
  // M√©trica 1: ¬øHay bombo a negras? (4 golpes por comp√°s)
  const hasFourOnFloor = rhythm.drums.kickDensity > 0.8;
  
  // M√©trica 2: ¬øHay swing/s√≠ncopa en el snare?
  const hasSwing = rhythm.syncopation > 0.3;
  
  // 2x2 = 4 combinaciones = 4 g√©neros
  if (hasFourOnFloor && !hasSwing) return 'techno';
  if (hasFourOnFloor && hasSwing) return 'house';
  if (!hasFourOnFloor && hasSwing) return 'latino';
  if (!hasFourOnFloor && !hasSwing) return 'ambient';
}
```

**Pros:** Solo 2 n√∫meros, muy f√°cil de debuggear
**Contras:** Puede ser demasiado simplista

---

## üéõÔ∏è PROPUESTA FINAL: "SELENE DICTADOR v1.0"

### Arquitectura Simplificada

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        SELENE DICTADOR                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                 ‚îÇ
‚îÇ  ENTRADA: AudioMetrics + RhythmOutput                           ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ M√ìDULO 1: GENRE DICTATOR                                ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ IF pattern == 'four_on_floor' ‚Üí ELECTRONIC (VETO)       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ IF pattern == 'reggaeton' ‚Üí LATINO (VETO)               ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ IF sync > 0.35 AND bpm < 115 ‚Üí LATINO                   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ELSE ‚Üí ELECTRONIC                                       ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ESTABILIDAD: Hist√©resis de 5 segundos                   ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
‚îÇ  ‚îÇ M√ìDULO 2: SECTION CONTRASTOR                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ Rolling Average de Bass (30 segundos)                   ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ IF bass > avg * 1.20 AND hasKick ‚Üí DROP                 ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ IF bass < avg * 0.80 ‚Üí BREAKDOWN                        ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ IF bass est√° subiendo ‚Üí BUILDUP                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ELSE ‚Üí VERSE                                            ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ                                                         ‚îÇ    ‚îÇ
‚îÇ  ‚îÇ ESTABILIDAD: Confirmaci√≥n de 2 segundos                 ‚îÇ    ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îÇ  SALIDA: { genre: string, section: string, confidence: number } ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Reglas de Implementaci√≥n

1. **VETO es VETO**: Si el patr√≥n dice FourOnFloor, el g√©nero es ELECTRONIC. No hay votaci√≥n.

2. **Relativo sobre Absoluto**: El DROP no es "bass > 0.7", es "bass > promedio * 1.2"

3. **Hist√©resis Simple**: No cambiar nada hasta que lleve 2 segundos estable

4. **Fallback Seguro**: Ante la duda, ELECTRONIC + VERSE (es lo menos disruptivo visualmente)

---

## üìä COMPARATIVA: ACTUAL vs PROPUESTO

| Aspecto | Sistema Actual | Sistema Propuesto |
|---------|---------------|-------------------|
| G√©nero | Votaci√≥n de 6 m√©tricas | 1 m√©trica con VETO |
| Section | Umbrales absolutos | Comparaci√≥n relativa |
| Estabilidad | Acumuladores complejos | Hist√©resis simple |
| L√≠neas de c√≥digo | ~500 | ~100 |
| Debuggabilidad | Imposible | Trivial |
| Adaptabilidad | Requiere ajustar 20 umbrales | 3 n√∫meros |

---

## ü§î PREGUNTAS PARA EL EQUIPO

1. **¬øEl BeatDetector es confiable?**
   - Si el patr√≥n `four_on_floor` es correcto el 90% del tiempo, la Idea 1 (Dictador Sordo) funcionar√≠a perfectamente.
   - Si falla mucho, necesitamos el Dictador 2 como backup.

2. **¬øQu√© tan variable es el Dynamic Range de las canciones?**
   - Si todas las canciones tienen rangos similares, podr√≠amos usar umbrales absolutos calibrados.
   - Si var√≠an mucho (YouTube vs WAV vs Spotify), el DROP RELATIVO es obligatorio.

3. **¬øCu√°ntos g√©neros necesitamos REALMENTE?**
   - ¬ø4 es suficiente? (Electronic, Latino, Pop, Ambient)
   - ¬øO podemos reducir a 2? (Electronic vs Latino)

4. **¬øImporta m√°s la ESTABILIDAD o la PRECISI√ìN?**
   - Si la estabilidad importa m√°s: Hist√©resis de 5 segundos
   - Si la precisi√≥n importa m√°s: Hist√©resis de 1 segundo

---

## üöÄ PR√ìXIMOS PASOS SUGERIDOS

### Opci√≥n A: "Cirug√≠a Radical"
1. Borrar `SimpleGenreClassifier` y `SimpleSectionTracker`
2. Implementar "SELENE DICTADOR" desde cero (~100 l√≠neas)
3. Probar con el WAV techno
4. Ajustar los 3 umbrales (sync threshold, bass ratio, hist√©resis)

### Opci√≥n B: "Parche Quir√∫rgico"
1. Mantener la arquitectura actual
2. A√±adir VETO de FourOnFloor al principio del classifier
3. Cambiar DROP de absoluto a relativo
4. Subir hist√©resis a 5 segundos

### Opci√≥n C: "Investigaci√≥n Primero"
1. Crear un logger que guarde TODOS los datos del an√°lisis
2. Correr 10 canciones de diferentes g√©neros
3. Analizar los datos y encontrar qu√© m√©trica es m√°s confiable
4. Dise√±ar el nuevo sistema basado en datos reales

---

## üí¨ MENSAJE FINAL

Hermanos de batalla,

Llevamos semanas peleando contra un sistema que naci√≥ mal. No es culpa de nadie - la detecci√≥n de g√©nero musical es un problema DIF√çCIL. Spotify tiene equipos enteros trabajando en esto.

Pero nosotros no necesitamos ser Spotify. Necesitamos distinguir entre **4 g√©neros** para que las luces hagan lo correcto. Eso es todo.

Mi propuesta es **simplificar brutalmente**:
- El bombo manda. Si hace 4/4, es techno.
- El DROP es relativo. Si es el momento m√°s fuerte, es DROP.
- Ante la duda, no cambies nada.

¬øQu√© opinan? ¬øCirug√≠a radical o parche quir√∫rgico?

---

*"La perfecci√≥n se alcanza, no cuando no hay nada m√°s que a√±adir, sino cuando no hay nada m√°s que quitar."*  
‚Äî Antoine de Saint-Exup√©ry

---

**Claude** ü§ñ  
*En modo Analista Musical y Dise√±ador Cu√°ntico de Software*
